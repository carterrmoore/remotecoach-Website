(window["wpJsonpExtractCss"]=window["wpJsonpExtractCss"]||[]).push([[11],{"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/AddLinkToSiteNavButton.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=a(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var d=a(r("./common/temp/node_modules/react/index.js"));var u=r("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var c=r("./src/main/webapp/universal/src/shared/i18n/react.ts");var s=r("./src/main/webapp/frontend/packages/universal-router/lib/index.js");var p=r("./src/main/webapp/universal/src/shared/utils/commerce/analytics/trackNestedCategory.ts");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));r.push.apply(r,a)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),true).forEach(function(e){(0,o.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var m=function e(t){var r=window.Y.Squarespace.Singletons.TemplateNavigationList.item(0).get("itemList");window.Y.Squarespace.Navigation.Events.fire("collection:create",{type:"link",modelList:r,opts:i({index:0},t,{openModalForConfiguredUrl:true})})};var l=function e(t){var r=t.callerName,a=t.displayName,o=t.fullUrl,s=t.requestCloseOriginatingModal,n=t.router,i=t.selectedCategory;var l=function e(){(0,p.trackChangeCategorySetting)("add-to-site-header",true,i,r);s(function(){n.push("/config/pages");setTimeout(function(){m({newWindow:false,title:a,url:o})},0)})};return d.default.createElement(u.Box,{mx:2,mt:1,px:2},d.default.createElement(u.Button.Tertiary,{onClick:l},d.default.createElement(c.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Add to your main navigation")))};var f=(0,s.withRouter)(l);t.default=f;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/CategoriesDetailsEditor.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var o=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var L=o(r("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var B=o(r("./common/temp/node_modules/@babel/runtime/regenerator/index.js"));var q=o(r("./common/temp/node_modules/@babel/runtime/helpers/asyncToGenerator.js"));var F=o(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var H=o(r("./common/temp/node_modules/@babel/runtime/helpers/slicedToArray.js"));r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var W=r("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var V=o(r("./common/temp/node_modules/@sqs/core-components/modals/AlertModal.js"));var U=r("./common/temp/node_modules/@sqs/jsf-fields/lib/es/main.js");var G=o(r("./common/temp/node_modules/@sqs/core-components/fields/PrefixSuffixField.js"));var $=o(r("./common/temp/node_modules/classnames/index.js"));var Y=a(r("./common/temp/node_modules/react/index.js"));var z=o(r("./src/main/webapp/universal/src/shared/components/Form/index.js"));var X=r("./src/main/webapp/universal/src/shared/i18n/react.ts");var J=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var Z=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/AddLinkToSiteNavButton.tsx"));var K=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less"));var Q=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/schema.ts"));var ee=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/uischema.ts"));var te=r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesAPI.ts");var re=r("./src/main/webapp/universal/src/shared/utils/commerce/analytics/trackNestedCategory.ts");function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));r.push.apply(r,a)}return r}function ae(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),true).forEach(function(e){(0,F.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var oe=function e(){return null};var n=function e(s){var t=(0,J.t)("Couldn't update categories");var r=(0,J.t)("Try again");var a=(0,Y.useState)(s.selectedCategory),o=(0,H.default)(a,2),n=o[0],i=o[1];var l=(0,Y.useState)(s.selectedCategory),d=(0,H.default)(l,2),u=d[0],c=d[1];var p=(0,Y.useState)(false),m=(0,H.default)(p,2),f=m[0],g=m[1];var v=(0,Y.useState)(t),h=(0,H.default)(v,2),y=h[0],C=h[1];var b=(0,Y.useState)(r),E=(0,H.default)(b,2),w=E[0],T=E[1];var N=(0,Y.useRef)(true);var S=s.renderCustomEditingHeader;var D=(0,Y.useRef)(n);var x=(0,Y.useRef)(u);(0,Y.useEffect)(function(){D.current=n},[n]);(0,Y.useEffect)(function(){x.current=u},[u]);var _=null===n||void 0===n?void 0:n.menuVisibility;var j=null===n||void 0===n?void 0:n.pageVisibility;var O=function e(){if(n){var t=n;return ae({},t,{pageVisibility:!t.ancestorPageHidden&&t.pageVisibility,menuVisibility:!t.ancestorMenuHidden&&t.menuVisibility,menuVisibilityDisabled:t.ancestorMenuHidden,pageVisibilityDisabled:t.ancestorPageHidden,fullSlug:t.slugPrefix})}return{displayName:"",id:"",menuVisibility:false,pageVisibility:false,shortSlug:"",fullSlug:"",orderedItemIds:[],slugPrefix:""}};var A=function(){var t=(0,q.default)(B.default.mark(function e(){var r;var a,o;return B.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:if(!(null!==(r=D.current)&&void 0!==r&&r.displayName)){t.next=9;break}c(D.current);t.next=4;return(0,te.updateCategory)(D.current,s.model.websiteId,s.model.collectionId,s.categoriesType).catch(function(e){var t,r,a;if(null!==(t=e.response.data)&&void 0!==t&&null!==(r=t.details)&&void 0!==r&&null!==(a=r.shortSlug[0])&&void 0!==a&&a.includes("properly formatted")){T((0,J.t)("URL slugs can only contain letters A-z and numbers 0-9."));C((0,J.t)("Invalid characters"))}g(true);throw e});case 4:a=t.sent;o=a.categoryTree;s.onCategoryUpdate&&s.onCategoryUpdate(o);t.next=10;break;case 9:g(true);case 10:case"end":return t.stop()}},e)}));return function e(){return t.apply(this,arguments)}}();(0,Y.useEffect)(function(){var e=D.current.menuVisibility;var t=D.current.pageVisibility;if(N.current){N.current=false;return}x.current.menuVisibility!==e&&(0,re.trackChangeCategorySetting)("filter-visibility",!!e,n,s.callerName);x.current.pageVisibility!==t&&(0,re.trackChangeCategorySetting)("page-visibility",!!t,n,s.callerName);A()},[_,j]);var I=O();var P=Y.default.useMemo(function(){return{TextareaField:function e(t){return Y.default.createElement(U.textarea,(0,L.default)({},t,{onBlur:function e(){if(x.current.displayName!==D.current.displayName){(0,re.trackChangeCategorySetting)("name",t.value,n,s.callerName);A()}}}))},PrefixSuffixField:function e(t){return Y.default.createElement(G.default,(0,L.default)({},t,{onBlur:function e(){if(x.current.shortSlug!==D.current.shortSlug){(0,re.trackChangeCategorySetting)("slug",t.value,n,s.callerName);A()}}}))},addLinkToSiteNavButton:function e(){return Y.default.createElement(Z.default,{callerName:s.callerName,displayName:I.displayName,fullUrl:"/".concat(s.collectionUrlId).concat(I.slugPrefix).concat(I.shortSlug),requestCloseOriginatingModal:s.requestCloseOriginatingModal,selectedCategory:n})},BooleanField:function e(r){return Y.default.createElement(U.boolean,(0,L.default)({},r,{onChange:function e(t){r.onChange(t)}}))}}},[s.collectionUrlId,s.requestCloseOriginatingModal]);var R=s.stylesOverride||K.default;var k=function e(t){var r=t.value;i(ae({},n,{},r))};var M=function e(){g(false);T(r);C(t)};return Y.default.createElement("div",{className:(0,$.default)(K.default.popupStyles,R.popupStyles)},Y.default.createElement(V.default,{isOpen:f,onDismiss:M,onRequestClose:M,title:y,message:w,buttonLabel:(0,J.t)("OK")}),S&&S(),Y.default.createElement("div",{className:(0,$.default)((0,F.default)({},K.default.hidden,S))},Y.default.createElement("div",{className:(0,$.default)(K.default.closeAction)},Y.default.createElement(W.BackButton,{onClick:s.closeCategoryDetails,ml:-1},Y.default.createElement(X.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Back")))),Y.default.createElement("div",{className:(0,$.default)(K.default.flyoutTitle,K.default.flyoutTitleSelected)},Y.default.createElement(X.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Edit Category")),Y.default.createElement("div",{className:K.default.formView},Y.default.createElement(z.default,{components:ae({hidden:U.hidden,spacer:U.spacer,ContextField:U.context},P),configurations:{default:{schema:Q.default,uiSchema:ee.default,value:O()}},panelClassName:K.default.editPanelMargin,renderHeader:oe,onChange:k})))};n.defaultProps={categoriesType:"products"};var i=n;t.default=i;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/index.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=a(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/CategoriesDetailsEditor.tsx"));var s=o.default;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/schema.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var a={$schema:"http://json-schema.org/draft-04/schema",properties:{displayName:{type:"string"},menuVisibility:{type:"boolean"},pageVisibility:{type:"boolean"},shortSlug:{type:"string"},fullSlug:{type:"string"}},type:"object"};var o=a;t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/uischema.ts":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var s=a(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less"));var n={$mapping:"#/menuVisibility",properties:{className:s.default.filterPadding,description:(0,o.t)("When enabled, this Category will be visible in your store filters."),label:(0,o.t)("Filter Visibility")},$conditional:{$if:{"#/menuVisibilityDisabled":{eq:true}},$then:{properties:{isDisabled:true}}},$sideEffects:[{$if:{$pointer:"#/menuVisibility",$comparator:{eq:true}},$then:{set:{$mapping:"#/pageVisibility",value:true}}}],type:"BooleanField"};var i={$mapping:"#/pageVisibility",properties:{label:(0,o.t)("Enable Page"),description:(0,o.t)("Disabled pages can’t be accessed by your site visitors.")},$conditional:{$if:{"#/pageVisibilityDisabled":{eq:true}},$then:{properties:{isDisabled:true}}},$sideEffects:[{$if:{$pointer:"#/pageVisibility",$comparator:{eq:false}},$then:{set:{$mapping:"#/menuVisibility",value:false}}}],type:"BooleanField"};var l={$mapping:"#/shortSlug",type:"PrefixSuffixField",properties:{label:(0,o.t)("URL slug"),prefix:"/",includePrefixOnChange:false},$conditional:{$if:{"#/shortSlug":{exists:true}},$then:{properties:{prefix:{$data:"#/fullSlug"},className:s.default.fullSlugPrefix,includePrefixOnChange:false}}}};var d={type:"addLinkToSiteNavButton"};var u={$mapping:"#/displayName",properties:{label:(0,o.t)("Name")},type:"TextareaField"};var c={type:"spacer",properties:{gridMultiplier:2}};var p=[u,l,c,i,n,c,d];var m=p;t.default=m;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CustomDragLayer.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.CustomDragLayer=void 0;var d=a(r("./common/temp/node_modules/react/index.js"));var u=a(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less"));var c=r("./common/temp/node_modules/react-dnd/dist/esm/index.js");var p={position:"fixed",pointerEvents:"none",left:0,top:0,width:"100%",height:"100%"};var m=18;var o=function e(o){var t=(0,c.useDragLayer)(function(e){return{item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging(),getClientOffset:e.getClientOffset()}}),r=t.isDragging,a=t.item,s=t.getClientOffset,n=t.currentOffset;function i(){return d.default.createElement("div",{className:u.default.dragLayerStyle},a.name)}function l(){var e=o.parentOffset;if(!n)return{display:"none"};var t=n.x,r=n.y;if(s&&e){t=s.x-e.x;r=s.y-e.y-m}var a="translate(".concat(t,"px, ").concat(r,"px)");return{transform:a}}if(!r)return null;return d.default.createElement("div",{style:p},d.default.createElement("div",{style:l()},i()))};t.CustomDragLayer=o},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/EditingPopover.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var u=r("./src/main/webapp/universal/src/shared/i18n/react.ts");var c=r("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var p=a(r("./common/temp/node_modules/@sqs/core-components/containers/PopOver.js"));var m=a(r("./common/temp/node_modules/react/index.js"));var f=a(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less"));var o=function e(t){var r=t.category,a=t.toggleDropdownVisibility,o=t.toggleAddCategoryInput,s=t.deleteCategory,n=t.summonDetailedEditor,i=t.treeDepth;var l={"&:hover":{backgroundColor:"gray.900"},py:"2",px:{_:"4","mobile-*":"3"},border:"0",borderWidth:"0"};var d=r.level>=i;return m.default.createElement(p.default,{className:f.default.categoryPopover,anchor:r.anchorNode,isOpen:r.showEditingPopover||false,closeOnClickOutside:true,onRequestClose:a(false,r),position:"bottom-center",ignoreTargetSelectors:[".".concat(f.default.disclosure)],hideArrow:true},m.default.createElement(c.Flex,{flexDirection:"column",py:1},m.default.createElement(c.Button.Secondary,{sx:l,onClick:n(r)},m.default.createElement(u.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Edit")),!d&&m.default.createElement(c.Button.Secondary,{sx:l,onClick:o(r),disabled:d},m.default.createElement(u.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Add")),m.default.createElement(c.Button.Secondary,{"data-test":"category-dropdown-delete-btn",color:"red",sx:l,onClick:s(r)},m.default.createElement(u.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Delete"))))};var s=o;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/NestedCategoriesEditor.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var o=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var b=o(r("./common/temp/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var E=o(r("./common/temp/node_modules/@babel/runtime/regenerator/index.js"));var i=o(r("./common/temp/node_modules/@babel/runtime/helpers/asyncToGenerator.js"));var s=o(r("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var n=o(r("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=o(r("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=o(r("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var u=o(r("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var c=o(r("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var p=o(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var m=r("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var f=o(r("./src/main/webapp/frontend/packages/enums/Flag.js"));var g=r("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var v=r("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var h=o(r("./common/temp/node_modules/@sqs/core-components/primitives/Checkbox.js"));var y=r("./common/temp/node_modules/@sqs/rosetta-icons/build/lib/index.js");var C=o(r("./common/temp/node_modules/@sqs/core-components/modals/AlertModal.js"));var w=o(r("./common/temp/node_modules/classnames/index.js"));var T=a(r("./common/temp/node_modules/react/index.js"));var N=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/HoverController.tsx"));var S=r("./common/temp/node_modules/react-dnd/dist/esm/index.js");var D=r("./common/temp/node_modules/react-dnd-html5-backend/dist/esm/index.js");var x=r("./src/main/webapp/universal/src/shared/i18n/react.ts");var _=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var j=r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesTree.ts");var O=r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesAPI.ts");var A=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CategoriesDetailsEditor/index.tsx"));var I=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/NestedDragContainer.tsx"));var P=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less"));var R=o(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/EditingPopover.tsx"));var k=o(r("./src/main/webapp/universal/src/shared/utils/polyfillIntersectionObserver.ts"));var M=r("./common/temp/node_modules/@sqs/rosetta-compositions/build/lib/index.js");var L=r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/CustomDragLayer.tsx");var B=r("./src/main/webapp/universal/src/shared/utils/commerce/analytics/trackNestedCategory.ts");var q=r("./src/main/webapp/frontend/packages/universal-flags/lib/index.js");function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));r.push.apply(r,a)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),true).forEach(function(e){(0,p.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function W(o){var s=V();return function e(){var t=(0,c.default)(o),r;if(s){var a=(0,c.default)(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return(0,u.default)(this,r)}}function V(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}var U=function(e){(0,d.default)(o,e);var a=W(o);function o(){var C;(0,s.default)(this,o);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];C=a.call.apply(a,[this].concat(t));(0,p.default)((0,l.default)(C),"defaultErrorTitle",(0,_.t)("Couldn't update category"));(0,p.default)((0,l.default)(C),"defaultErrorMessage",(0,_.t)("Try again"));(0,p.default)((0,l.default)(C),"state",{categoriesApiResponse:{categoryTree:[]},showError:false,showErrorModal:false,categoriesTree:new j.CategoriesTree({},{}),newCategoryName:"",searchTerm:"",isHeaderIntersecting:true,selectedCategories:C.props.model.categoryIds||[],showEmptyState:false,showAddField:false,showDetailedEditor:false,showRemoveCategoryConfirmation:false,firstTreeLoadPending:true,errorTitle:C.defaultErrorTitle,errorMessage:C.defaultErrorMessage,isLoadingNetworkRequest:false});(0,p.default)((0,l.default)(C),"scrollTarget",void 0);(0,p.default)((0,l.default)(C),"scrollContainer",void 0);(0,p.default)((0,l.default)(C),"topLevelContainer",void 0);(0,p.default)((0,l.default)(C),"observer",void 0);(0,p.default)((0,l.default)(C),"dismissErrorModal",function(){C.setState({showErrorModal:false,errorMessage:C.defaultErrorMessage,errorTitle:C.defaultErrorTitle})});(0,p.default)((0,l.default)(C),"isValidDragOperation",function(e,t){if(!e||!t)return false;if(t.id===e)return false;var r=C.state.categoriesTree.findNode(e);if(C.state.categoriesTree.isChild(r,t)||C.state.searchTerm)return false;return true});(0,p.default)((0,l.default)(C),"cancelDrag",function(e){var t=C.state.categoriesTree.cloneTree();t.findNode(e).isDragging=false;C.clearHoveredState(t);C.setState({categoriesTree:t})});(0,p.default)((0,l.default)(C),"toggleHideChildren",function(s){return function(){var t=(0,i.default)(E.default.mark(function e(r){var a,o;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:r.preventDefault();r.stopPropagation();a=C.state.categoriesTree.cloneTree();o=a.findNode(s.id);o.hideChildren=!o.hideChildren;C.setState({categoriesTree:a});case 6:case"end":return t.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()});(0,p.default)((0,l.default)(C),"initializeDragHoverState",function(e){var t=e.nodeId,r=e.tree;var a=e.dropNode;if(!t||!a)return;if(a.id===t)return;var o=C.state.categoriesTree.findNode(t);if(C.state.categoriesTree.isChild(o,a)||C.state.searchTerm)return;o=r.findNode(t);a=r.findNode(a.id);o.isDragging=true;return{node:o,dropNodeInTree:a}});(0,p.default)((0,l.default)(C),"renderCategoryHeaderText",function(e){return T.default.createElement(T.default.Fragment,null,e>0?T.default.createElement(x.Plural,{n:e,forms:{one:"1 category selected",other:"{%n} categories selected"},project:"apps.App.Commerce.NestedCategoriesEditor"}):T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Select a Category"))});(0,p.default)((0,l.default)(C),"renderNoCategoryState",function(){return T.default.createElement(v.Flex,{flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:C.state.showAddField?0:2},T.default.createElement(v.Text.Title,{color:"gray.400",textAlign:"center"},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"No Categories")),T.default.createElement(v.Text.Body,{color:"gray.400",textAlign:"center"},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Organize products into categories like “New Arrivals” or “Accessories.”")),T.default.createElement(v.Box,{mt:6},T.default.createElement(v.Button.Tertiary,{onClick:function e(){C.setState({showEmptyState:false,showAddField:true})}},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Create Category"))))});(0,p.default)((0,l.default)(C),"renderToolTip",function(o){var s;return T.default.createElement(N.default,null,function(e){var t=e.isHovering,r=e.onMouseEnter,a=e.onMouseLeave;return T.default.createElement(T.default.Fragment,null,T.default.createElement("div",{className:P.default.iconContainer,ref:function e(t){s=t},onMouseEnter:r,"data-test":"hoverContainer",onMouseLeave:a},T.default.createElement(y.Hide,{width:16,height:16})),T.default.createElement(g.Tooltip,{anchor:s,isOpen:t,position:"top",onRequestClose:function e(){return null}},o?(0,_.t)("Disabled"):(0,_.t)("Not visible in filters")))})});(0,p.default)((0,l.default)(C),"renderCategoryDropdownButton",function(e){if(C.state.searchTerm)return null;return T.default.createElement(T.Fragment,null,Object.keys(e.children||{}).length>0&&T.default.createElement("button",{className:(0,w.default)(P.default.expandCollapse),onClick:C.toggleHideChildren(e)},T.default.createElement(y.ChevronSmallDown,{className:(0,w.default)(P.default.expandIcon,(0,p.default)({},P.default.rotateChevron,e.hideChildren))})))});(0,p.default)((0,l.default)(C),"clearHoveredState",function(e){e.getAllCategories().forEach(function(e){e.isPreviewParent=false;e.isReorderAfter=false;e.isReorderBefore=false})});(0,p.default)((0,l.default)(C),"reorderDrop",function(){var a=(0,i.default)(E.default.mark(function e(r,a,o){var s,n,i,l,d,u,c,p;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:if(C.isValidDragOperation(r,a)){t.next=3;break}C.cancelDrag(r);return t.abrupt("return");case 3:o||C.canReorderAfter(a,r)||(o=true);s=C.state.categoriesTree.cloneTree();C.clearHoveredState(s);n=s.findNode(r);a=s.findNode(a.id)||n;n.isDragging=false;n.hideChildren=true;i=s.findNode(n.parentCategoryId)||C.state.rootCategory;l=s.findNode(a.parentCategoryId)||C.state.rootCategory;if(!(i!==l&&!C.isCombinedTreeDepthBelowLimit(l,n))){t.next=15;break}C.cancelDrag(r);return t.abrupt("return");case 15:if(!(a.id===r)){t.next=17;break}return t.abrupt("return");case 17:d=a.displayIndex>n.displayIndex&&l===i?o?a.displayIndex-1:a.displayIndex:o?a.displayIndex:a.displayIndex+1;if(!(d===n.displayIndex&&l===i)){t.next=21;break}C.cancelDrag(r);return t.abrupt("return");case 21:n.displayIndex=d;n.parentCategoryId=l.id;n.parentNode=l;t.prev=24;C.setState({isLoadingNetworkRequest:true});if(!(i===l)){t.next=29;break}t.next=29;return(0,O.updateCategory)(n,C.props.model.websiteId,C.props.model.collectionId,C.props.categoriesType).catch(function(e){C.setState({showErrorModal:true});throw e});case 29:if(!(i!==l)){t.next=38;break}u=i.level||0;c=l.level||0;(0,B.trackChangeCategoryNesting)(n,u+1,c+1,C.props.callerName);p=C.props.model.collectionId;t.next=36;return(0,O.reparentCategory)(r,p,n.parentCategoryId,n.displayIndex);case 36:t.next=39;break;case 38:(0,B.trackReorderCategory)(n,n.displayIndex,C.props.callerName);case 39:t.next=41;return C.updateCategories();case 41:t.prev=41;C.setState({isLoadingNetworkRequest:false});return t.finish(41);case 44:case"end":return t.stop()}},e,null,[[24,,41,44]])}));return function(e,t,r){return a.apply(this,arguments)}}());(0,p.default)((0,l.default)(C),"reorderBefore",function(e,t){C.reorder(e,t,true)});(0,p.default)((0,l.default)(C),"reorder",function(e,t,r){if(!C.isValidDragOperation(e,t))return;r||C.canReorderAfter(t,e)||(r=true);var a=C.state.categoriesTree.cloneTree();var o=C.initializeDragHoverState({nodeId:e,dropNode:t,tree:a});if(!o)return;C.clearHoveredState(a);var s=o.node;s.isDragging=true;r?t.isReorderBefore=true:t.isReorderAfter=true;C.setState({categoriesTree:a})});(0,p.default)((0,l.default)(C),"reparentHover",function(e,t){if(!C.isValidDragOperation(e,t)||!C.canReparent(t,C.state.categoriesTree.findNode(e)))return;var r=C.state.categoriesTree.cloneTree();C.clearHoveredState(r);var a=C.initializeDragHoverState({nodeId:e,dropNode:t,tree:r});if(!a)return;var o=a.node,s=a.dropNodeInTree;var n=s;o.isDragging=true;n.isPreviewParent=true;C.setState({categoriesTree:r})});(0,p.default)((0,l.default)(C),"reparentDrop",function(){var r=(0,i.default)(E.default.mark(function e(r,a){var o,s,n;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:if(!(!C.isValidDragOperation(r,a)||!C.canReparent(a,C.state.categoriesTree.findNode(r)))){t.next=3;break}C.cancelDrag(r);return t.abrupt("return");case 3:t.prev=3;C.setState({isLoadingNetworkRequest:true});o=C.state.categoriesTree.cloneTree();s=o.findNode(r);s=o.findNode(r);s.parentCategoryId=a.id;s.parentNode=a;s.displayIndex=1;n=C.props.model.collectionId;t.next=14;return(0,O.reparentCategory)(r,n,a.id,s.displayIndex);case 14:t.next=16;return C.updateCategories();case 16:(0,B.trackChangeCategoryNesting)(s,s.level||1,(s.parentNode.level||0)+1,C.props.callerName);case 17:t.prev=17;C.setState({isLoadingNetworkRequest:false});return t.finish(17);case 20:case"end":return t.stop()}},e,null,[[3,,17,20]])}));return function(e,t){return r.apply(this,arguments)}}());(0,p.default)((0,l.default)(C),"closeCategoryDetails",(0,i.default)(E.default.mark(function e(){return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:C.setState({showDetailedEditor:false});t.next=3;return C.updateCategories();case 3:case"end":return t.stop()}},e)})));(0,p.default)((0,l.default)(C),"deleteCategory",function(n){return(0,i.default)(E.default.mark(function e(){var r,a,o,s;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:t.prev=0;C.setState({isLoadingNetworkRequest:true});r=q.legacyV6Flags.isFeatureEnabled(f.default.COMMERCE_PRODUCT_SERVICE_CATEGORY_DELETION);if(!r){t.next=9;break}a=C.props.model.collectionId;t.next=7;return(0,O.deleteCategory)(n.id,a,C.props.model.websiteId,C.props.categoriesType).catch(function(e){C.setState({showErrorModal:true});throw e});case 7:t.next=14;break;case 9:if(!n.parentCategoryId){t.next=12;break}t.next=12;return(0,O.moveItemsByCategory)(n.id,C.props.model.websiteId,C.props.model.collectionId,n.parentCategoryId||C.state.rootCategory.id).catch(function(e){C.setState({showErrorModal:true});throw e});case 12:t.next=14;return(0,O.deleteCategoryLegacy)(n.id,C.props.model.websiteId,C.props.model.collectionId).catch(function(e){C.setState({showErrorModal:true});throw e});case 14:o=(0,b.default)(C.state.selectedCategories);s=C.state.categoriesTree.getSelectedSubnodes(n,new Set([]));o=o.filter(function(e){return!s.has(e)});n.parentCategoryId&&o.push(n.parentCategoryId);C.setState({selectedCategories:o,showRemoveCategoryConfirmation:false,deleteCategory:void 0});(0,B.trackDeleteCategory)(n,C.props.callerName);t.next=22;return C.updateCategories();case 22:t.prev=22;C.setState({isLoadingNetworkRequest:false});return t.finish(22);case 25:case"end":return t.stop()}},e,null,[[0,,22,25]])}))});(0,p.default)((0,l.default)(C),"deleteCategoryModal",function(r){return function(){var e=C.state.categoriesTree.cloneTree();var t=e.findNode(r.id);t.showEditingPopover=false;C.setState({showRemoveCategoryConfirmation:true,categoriesTree:e,deleteCategory:r})}});(0,p.default)((0,l.default)(C),"cancelDelete",function(){C.setState({showRemoveCategoryConfirmation:false,deleteCategory:void 0})});(0,p.default)((0,l.default)(C),"toggleAddCategoryInput",function(s){return function(e){e.preventDefault();e.stopPropagation();if(s){var t=C.state.categoriesTree.cloneTree();var r=t.findNode(s.id);r.showEditingPopover=false;r.showAddField=!r.showAddField;C.state.parentToAdd&&C.state.parentToAdd.id!==s.id&&t.findNode(C.state.parentToAdd.id)&&(t.findNode(C.state.parentToAdd.id).showAddField=false);C.setState({categoriesTree:t,newCategoryName:"",parentToAdd:r,showAddField:false})}else{var a=C.state.categoriesTree.cloneTree();if(C.state.parentToAdd){var o=a.findNode(C.state.parentToAdd.id);o.showAddField=false}C.setState({categoriesTree:a,newCategoryName:"",parentToAdd:void 0,showAddField:!C.state.showAddField})}}});(0,p.default)((0,l.default)(C),"toggleCategory",function(y){return(0,i.default)(E.default.mark(function e(){var r,a,o,s,n,i,l,d,u,c,p,m,f,g,v,h;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:r=C.state.categoriesTree.cloneTree();a=r.findNode(y.id);o=C.props.toggleCategory;if(a.id){t.next=5;break}return t.abrupt("return");case 5:s=C.props.model,n=s.websiteId,i=s.collectionId,l=s.productId,d=s.productTitle,u=s.productType;c=(0,b.default)(C.state.selectedCategories);if(!a.selected){t.next=15;break}if(a.parentNode){p=C.state.rootCategory;m=a.parentCategoryId===p.id?C.state.categoriesTree.getTopLevelCategoryIds():Object.values(C.state.categoriesTree.findNode(a.parentCategoryId).children).map(function(e){return e.id});f=m.some(function(e){return r.findNode(e).selected&&e!==a.id});if(!f){a.parentNode.selected=true;c.push(a.parentNode.id)}}g=r.getSelectedSubnodes(a,new Set([]));(0,B.trackRemoveCategory)(y,C.props.callerName,{websiteId:n,collectionId:i,productId:l,productTitle:d,productType:u});o||(0,O.removeProductFromCategories)([a.id],l,n,i,C.props.categoriesType).then(function(){C.updateCategories()}).catch(function(e){C.setState({showErrorModal:true});throw e});c=c.filter(function(e){return!g.has(e)});t.next=29;break;case 15:(0,B.trackAssignCategory)(a,C.props.callerName,{websiteId:n,collectionId:i,productId:l,productTitle:d,productType:u});v=a;h=null;case 18:if(!v.parentNode){t.next=25;break}v=v.parentNode;if(!c.includes(v.id)){t.next=23;break}h=v;return t.abrupt("break",25);case 23:t.next=18;break;case 25:o||(0,O.assignCategory)([a.id],l,n,i,C.props.categoriesType).then(function(){C.updateCategories()}).catch(function(e){C.setState({showErrorModal:true});throw e});c.push(a.id);a.selected=true;if(h){h.selected=false;c=c.filter(function(e){if(e===h.id)return false;return true})}case 29:null===o||void 0===o?void 0:o([].concat((0,b.default)(c),[C.state.rootCategory.id]));C.setState({categoriesTree:r,selectedCategories:c},function(){return C.refreshTree()});case 31:case"end":return t.stop()}},e)}))});(0,p.default)((0,l.default)(C),"updateCategoryName",function(e){C.setState({newCategoryName:e.target.value})});(0,p.default)((0,l.default)(C),"searchCategories",function(e){C.setState({searchTerm:e})});(0,p.default)((0,l.default)(C),"canReorderAfter",function(e,t){return e.hideChildren||e.id===t||0===Object.keys(e.children).length||1===Object.keys(e.children).length&&e.children[t]});(0,p.default)((0,l.default)(C),"isCombinedTreeDepthBelowLimit",function(e,t){var r=C.props.maxTreeDepth;if(e.level>=r)return false;if(t){var a=C.state.categoriesTree.getSubTreeDepth(t);if(a+e.level>r)return false}return true});(0,p.default)((0,l.default)(C),"canReparent",function(e,t){if(!C.isCombinedTreeDepthBelowLimit(e,t))return false;if(!e.children||0===Object.keys(e.children).length||e.hideChildren)return true;return false});(0,p.default)((0,l.default)(C),"createMarkup",function(a,e,t,r){var o,s;var n=(0,w.default)((o={},(0,p.default)(o,P.default.hidden,!t),(0,p.default)(o,P.default.childCategory,e),(0,p.default)(o,P.default.category,!e),o));var i=(0,w.default)(P.default.separator,(s={},(0,p.default)(s,P.default.hovered,a.isPreviewParent),(0,p.default)(s,P.default.reorderAfter,a.isReorderAfter),(0,p.default)(s,P.default.reorderBefore,a.isReorderBefore),(0,p.default)(s,P.default.translucent,a.isDragging),(0,p.default)(s,P.default.grabbing,C.isDragInProgress()),s));var l=!a.pageVisibility||a.ancestorPageHidden;var d=!a.menuVisibility||a.ancestorMenuHidden;return T.default.createElement("div",{className:"".concat(n),key:a.id,"data-test":"category-list-item"},T.default.createElement("div",null,T.default.createElement(I.default,{reorderDrop:C.reorderDrop,canReparent:C.canReparent(a),reparentDrop:C.reparentDrop,preventDrag:C.state.searchTerm,reorderBefore:C.reorderBefore,reparentHover:C.reparentHover,cancelDrag:C.cancelDrag,item:a,reorderAfter:C.reorder,key:a.id},T.default.createElement("div",{className:"".concat(i),"data-test":"separator"},T.default.createElement("div",{className:P.default.dragHandleContainer},T.default.createElement(y.Drag,{className:(0,w.default)(P.default.dragIcon)})),C.renderCategoryDropdownButton(a),T.default.createElement("div",{className:(0,w.default)((0,p.default)({},P.default.translucent,r))},C.boldString(a.displayName)),T.default.createElement("div",{className:P.default.buttonAlignment},(l||d)&&C.renderToolTip(l),!C.isDragInProgress()&&T.default.createElement("button",{className:(0,w.default)(P.default.iconContainer),"data-test":"category-dropdown-options",onClick:C.toggleDropdownVisibility(true,a),ref:function e(t){a.anchorNode=t}},T.default.createElement("div",{className:(0,w.default)((0,p.default)({},P.default.openDisclosure,a.showEditingPopover),P.default.disclosure)},T.default.createElement(y.Ellipses,{width:16,height:16}))),!C.isDragInProgress()&&!C.props.hideCheckbox&&T.default.createElement(h.default,{className:P.default.iconContainer,value:a.selected,onChange:C.toggleCategory(a)}),T.default.createElement("div",{onClick:C.overrideProductEditorClick},T.default.createElement(R.default,{category:a,toggleDropdownVisibility:C.toggleDropdownVisibility,toggleAddCategoryInput:C.toggleAddCategoryInput,deleteCategory:C.deleteCategoryModal,summonDetailedEditor:C.props.customSummonDetailedEditor||C.summonDetailedEditor,treeDepth:C.props.maxTreeDepth})))))),a.showAddField&&!C.state.searchTerm&&T.default.createElement("div",{className:P.default.childCategory},T.default.createElement("form",{onSubmit:C.addCategory},T.default.createElement("input",{autoFocus:true,className:(0,w.default)(P.default.inputWidth),value:C.state.newCategoryName,placeholder:(0,_.t)("Add Category…"),onBlur:C.addCategory,onChange:C.updateCategoryName,onClick:C.overrideProductEditorClick}))),Object.keys(a.children||{}).length>0?Object.values(a.children||{}).sort(C.sortCategories).map(function(e){var t=false;var r=false;e=C.state.categoriesTree.findNode(e.id);if(e.displayName.toUpperCase().includes(C.state.searchTerm.toUpperCase())||C.state.categoriesTree.descendantNameContainsString(e,C.state.searchTerm)){t=true;e.displayName.toUpperCase().includes(C.state.searchTerm.toUpperCase())||(r=true)}return!a.hideChildren&&!a.isDragging&&C.createMarkup(e,true,t,r)}):null)});(0,p.default)((0,l.default)(C),"boldString",function(e){if(!C.state.searchTerm)return e;var r=C.state.searchTerm;var t=new RegExp("(".concat(r,")"),"gi");var a=e.split(t);return a.map(function(e,t){if(e.toUpperCase()===r.toUpperCase())return T.default.createElement("b",{key:"".concat(e,"_").concat(t)},e);return e})});(0,p.default)((0,l.default)(C),"isDragInProgress",function(){return C.state.categoriesTree.getAllCategories().some(function(e){return e.isDragging||false})});(0,p.default)((0,l.default)(C),"toggleDropdownVisibility",function(a,o){return function(e){e.preventDefault();e.stopPropagation();var t=C.state.categoriesTree.cloneTree();var r=t.findNode(o.id);t.getAllCategories().forEach(function(e){e.showEditingPopover=false});r.showEditingPopover?r.showEditingPopover=false:r.showEditingPopover=a;C.setState({categoriesTree:t})}});(0,p.default)((0,l.default)(C),"summonDetailedEditor",function(t){return function(e){e.preventDefault();e.stopPropagation();t.showEditingPopover=false;C.setState({selectedCategory:t,showDetailedEditor:true})}});(0,p.default)((0,l.default)(C),"overrideProductEditorClick",function(e){e.stopPropagation()});(0,p.default)((0,l.default)(C),"sortCategoriesByReference",function(e,t){var r=C.state.categoriesTree.findNode(e);var a=C.state.categoriesTree.findNode(t);return C.sortCategories(r,a)});(0,p.default)((0,l.default)(C),"sortCategories",function(e,t){return e.displayIndex<t.displayIndex?-1:1});(0,p.default)((0,l.default)(C),"addCategory",function(){var t=(0,i.default)(E.default.mark(function e(r){var a,o,s,n;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:r.preventDefault();r.stopPropagation();t.prev=2;C.setState({isLoadingNetworkRequest:true});a=C.state.parentToAdd;o=C.state.searchTerm||C.state.newCategoryName;if(!(o&&o.length>0)){t.next=16;break}s={displayName:o,id:(null===a||void 0===a?void 0:a.id)||C.state.rootCategory.id,shortSlug:o.toLowerCase().trim().replace(/\s+/g,""),orderedItemIds:[]};t.next=10;return(0,O.createCategories)(s,C.props.model.websiteId,C.props.model.collectionId,C.props.categoriesType).catch(function(e){var t,r,a;null!==(t=e.data)&&void 0!==t&&null!==(r=t.details)&&void 0!==r&&null!==(a=r.displayName[0])&&void 0!==a&&a.includes("not unique")?C.setState({showErrorModal:true,errorTitle:(0,_.t)("{name} already exists",{name:o}),errorMessage:(0,_.t)("Please create a unique name for your new category.")}):C.setState({showErrorModal:true});throw e});case 10:n=t.sent;C.setState({searchTerm:"",newCategoryName:"",parentToAdd:void 0,showAddField:false});t.next=14;return C.updateCategories();case 14:(0,B.trackCreateCategory)(s,C.props.callerName);"product-composer"===C.props.callerName&&C.toggleCategory(n)();case 16:t.prev=16;C.setState({isLoadingNetworkRequest:false});return t.finish(16);case 19:case"end":return t.stop()}},e,null,[[2,,16,19]])}));return function(e){return t.apply(this,arguments)}}());(0,p.default)((0,l.default)(C),"updateCategories",(0,i.default)(E.default.mark(function e(){var r,a;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return(0,O.getCategories)(C.props.model.collectionId,C.props.model.websiteId,C.props.categoriesType).catch(function(e){C.setState({showErrorModal:true});throw e});case 2:r=t.sent;a=r.categoryTree[0];C.setState({showEmptyState:C.props.isEmptyState&&r.categoryTree.length<2,showAddField:!C.props.isEmptyState&&r.categoryTree.length<2,categoriesApiResponse:r,rootCategory:H({},a,{menuVisibility:!a.menuHidden,pageVisibility:"LIST_VIEW"===a.pageRendering}),showError:false},function(){C.refreshTree()});case 5:case"end":return t.stop()}},e)})));(0,p.default)((0,l.default)(C),"setNames",function(e){if(C.props.setCategories){var t=e.getAllCategories().filter(function(e){return e.selected}).map(function(e){return{id:e.id,name:e.displayName}});C.props.setCategories(t)}});(0,p.default)((0,l.default)(C),"closeModal",function(){var e=C.props.closeModal;e()});return C}(0,n.default)(o,[{key:"componentDidMount",value:function(){var e=(0,i.default)(E.default.mark(function e(){var r=this;return E.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:"product-settings-modal"!==this.props.callerName&&(0,B.trackUserViewProductCollectionSettingsPanel)("nested-categories","product-editor",this.props.callerName);t.next=3;return this.updateCategories().then(function(){r.setState({firstTreeLoadPending:false})}).catch(function(){r.setState({showError:true,firstTreeLoadPending:false})});case 3:case"end":return t.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"componentWillUnmount",value:function e(){this.observer&&this.observer.disconnect()}},{key:"componentDidUpdate",value:function e(){var a=this;if(this.scrollTarget&&this.scrollContainer&&!this.observer&&null!==this.observer){this.observer=null;(0,k.default)().then(function(){var e={root:a.scrollContainer,threshold:.5};var t=a.scrollTarget;var r=function e(t){a.setState({isHeaderIntersecting:t[0].isIntersecting})};a.observer=new IntersectionObserver(r,e);a.observer.observe(t)})}}},{key:"renderHeader",value:function e(t){if(this.props.renderHeader)return this.props.renderHeader();return T.default.createElement("div",{className:P.default.flyoutHeader},T.default.createElement("div",{className:(0,w.default)((0,p.default)({},P.default.flyoutTitleSelected,t>0),P.default.flyoutTitle,P.default.flyoutTitleColor)},this.renderCategoryHeaderText(t)))}},{key:"render",value:function e(){var o=this,t;var s=this.state.categoriesTree;var r=this.props.stylesOverride||P.default;var a=s.getTopLevelCategoryIds();var n=s.getAllCategories().filter(function(e){return e.selected}).length;return T.default.createElement("div",{onClick:this.overrideProductEditorClick,ref:function e(t){o.topLevelContainer=t}},T.default.createElement(S.DndProvider,{backend:D.HTML5Backend},T.default.createElement(C.default,{isOpen:this.state.showErrorModal,onDismiss:this.dismissErrorModal,onRequestClose:this.dismissErrorModal,title:this.state.errorTitle,message:this.state.errorMessage,buttonLabel:(0,_.t)("OK")}),T.default.createElement(L.CustomDragLayer,{parentOffset:this.props.containerRef?this.props.containerRef.getBoundingClientRect():null===(t=this.topLevelContainer)||void 0===t?void 0:t.getBoundingClientRect()}),T.default.createElement("div",{className:(0,w.default)((0,p.default)({},P.default.showEditor,this.state.showDetailedEditor))},T.default.createElement("div",{className:P.default.fixedWidth},T.default.createElement("div",{className:(0,w.default)(P.default.popupStyles,r.popupStyles)},!this.props.renderHeader&&T.default.createElement("div",{className:(0,w.default)(P.default.flyoutHeader,P.default.closeAction)},T.default.createElement(v.Button.Tertiary,{onClick:this.closeModal,"data-test":"categories-editor-done-btn"},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Done")),!this.state.isHeaderIntersecting&&!this.state.showError&&!this.props.isLoading&&T.default.createElement("div",{className:(0,w.default)((0,p.default)({},P.default.flyoutTitleSelected,n>0),P.default.flyoutTitleColor)},this.renderCategoryHeaderText(n))),(this.props.isLoading||this.state.firstTreeLoadPending)&&T.default.createElement("div",{className:(0,w.default)(P.default.flyoutWidth,r.flyoutWidth,P.default.showLoading)},T.default.createElement(g.ActivityIndicator,null)),this.state.showError&&T.default.createElement("div",{className:(0,w.default)(P.default.flyoutWidth,r.flyoutWidth,P.default.showError)},T.default.createElement("div",null,T.default.createElement(v.Text.Title,{css:{color:m.colors.gray["400"]}},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Couldn't Load Categories"))),T.default.createElement("div",null,T.default.createElement(v.Text.Subtitle,{css:{color:m.colors.gray["400"]}},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Try reloading."))),T.default.createElement("button",{className:P.default.upperCase,onClick:this.updateCategories},T.default.createElement(v.Text.Caption,{css:{color:m.colors.gray["100"]}},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Reload")))),!this.state.showError&&!this.props.isLoading&&!this.state.firstTreeLoadPending&&T.default.createElement("div",{className:(0,w.default)(P.default.flyoutWidth,r.flyoutWidth),ref:function e(t){o.scrollContainer=t}},this.state.showEmptyState?this.renderNoCategoryState():T.default.createElement(T.default.Fragment,null,this.props.renderHeader?this.renderHeader(n):T.default.createElement("div",{ref:function e(t){o.scrollTarget=t}},this.renderHeader(n)),a.length>0&&T.default.createElement("form",{onSubmit:this.addCategory,className:(0,w.default)(P.default.searchContainer)},T.default.createElement(y.Search,{color:"gray.400",css:{alignSelf:"center"}}),T.default.createElement(g.TextInput,{pl:2,value:this.state.searchTerm,onChange:this.searchCategories,"data-test":"pc2-add-category",placeholder:(0,_.t)("Add or Search for a Category")}),T.default.createElement(v.Button.Tertiary,{type:"submit",textAlign:"right",onClick:this.addCategory,disabled:!this.state.searchTerm},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Add")))),this.state.showAddField&&!this.state.searchTerm&&T.default.createElement("form",{onSubmit:this.addCategory,className:(0,w.default)(P.default.addContainer)},T.default.createElement("input",{autoFocus:true,className:(0,w.default)(P.default.inputWidth),value:this.state.newCategoryName,placeholder:(0,_.t)("Add Category…"),"data-test":"pc2-add-category",onChange:this.updateCategoryName,onClick:this.overrideProductEditorClick}),T.default.createElement(v.Button.Tertiary,{type:"submit",textAlign:"right",onClick:this.addCategory},T.default.createElement(x.T,{project:"apps.App.Commerce.NestedCategoriesEditor"},"Add"))),this.state.isLoadingNetworkRequest&&T.default.createElement("div",{className:(0,w.default)(P.default.flyoutWidth,r.flyoutWidth,P.default.showLoading)},T.default.createElement(g.ActivityIndicator,null)),!this.state.showError&&!this.props.isLoading&&!this.state.isLoadingNetworkRequest&&a.sort(this.sortCategoriesByReference).map(function(e){var t=s.findNode(e);var r=false;var a=false;if(t.displayName.toUpperCase().includes(o.state.searchTerm.toUpperCase())||s.descendantNameContainsString(t,o.state.searchTerm)){r=true;t.displayName.toUpperCase().includes(o.state.searchTerm.toUpperCase())||(a=true)}return o.createMarkup(t,false,r,a)}),this.state.showRemoveCategoryConfirmation&&this.renderRemoveConfirmation()))),T.default.createElement("div",{className:(0,w.default)(P.default.fixedWidth,(0,p.default)({},P.default.hideDetailedEditor,!this.state.showDetailedEditor))},this.state.showDetailedEditor&&T.default.createElement(A.default,{callerName:this.props.callerName,collectionUrlId:this.props.collectionUrlId,selectedCategory:this.state.selectedCategory,requestCloseOriginatingModal:this.props.requestCloseOriginatingModal,stylesOverride:r,closeCategoryDetails:this.closeCategoryDetails,model:this.props.model})))))}},{key:"renderRemoveConfirmation",value:function e(){var t=this;return T.default.createElement(g.Modal.Transition,null,this.state.showRemoveCategoryConfirmation&&T.default.createElement(g.Modal,{onRequestClose:this.cancelDelete,className:P.default.categoryPopover},T.default.createElement(g.Modal.Overlay,null),T.default.createElement(g.Modal.Position,{position:"center"},T.default.createElement(M.AlertDialog,{title:(0,_.t)("Delete category?"),message:(0,_.t)("Removing this category will also delete all of the sub-categories within it."),buttons:[function(){return T.default.createElement(M.AlertDialog.Button,{key:"Cancel",onClick:t.cancelDelete},(0,_.t)("Cancel"))},function(){return T.default.createElement(M.AlertDialog.Button,{key:"Confirm",onClick:t.deleteCategory(t.state.deleteCategory),"data-test":"confirm-delete-category"},(0,_.t)("Delete"))}]}))))}},{key:"refreshTree",value:function e(){var t=this.state.categoriesApiResponse.categoryTree;var r=j.CategoriesTree.constructCategoriesTree(t,this.state.selectedCategories,this.state.rootCategory);var a=r.getExplicitIdsOnly(this.state.selectedCategories);this.setState({categoriesTree:r,selectedCategories:a});this.setNames(r);this.props.onTreeRefresh&&this.props.onTreeRefresh(t)}}]);return o}(T.default.Component);t.default=U;(0,p.default)(U,"defaultProps",{categoriesType:"products",maxTreeDepth:3});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/NestedDragContainer.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=a(r("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=a(r("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var n=a(r("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=a(r("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var l=a(r("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var d=a(r("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var u=a(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var c=a(r("./common/temp/node_modules/lodash/flow.js"));var p=r("./common/temp/node_modules/react-dnd-html5-backend/dist/esm/index.js");var m=a(r("./common/temp/node_modules/react/index.js"));var f=r("./common/temp/node_modules/react-dnd/dist/esm/index.js");function g(o){var s=v();return function e(){var t=(0,d.default)(o),r;if(s){var a=(0,d.default)(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return(0,l.default)(this,r)}}function v(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}var h;(function(e){e["reparent"]="REPARENT";e["reorderBefore"]="REORDERBEFORE";e["reorderAfter"]="REORDERAFTER";e["reset"]="RESET"})(h=h||{});var y="item";var C=45;var b=1*C/3;var E=2*C/3;var w=function(e){(0,i.default)(a,e);var r=g(a);function a(e){var t;(0,o.default)(this,a);t=r.call(this,e);(0,u.default)((0,n.default)(t),"dom",void 0);t.dom=null;return t}(0,s.default)(a,[{key:"componentDidMount",value:function e(){var t=this.props.connectDragPreview;t&&t((0,p.getEmptyImage)(),{captureDraggingState:true})}},{key:"render",value:function e(){var r=this;var t=this.props,a=t.connectDragSource,o=t.connectDropTarget;return o(a(m.default.createElement("div",{ref:function e(t){return r.dom=t}},this.props.children)))}},{key:"componentDidUpdate",value:function e(t,r){if(this.props.dragSourceId===this.props.item.id||0===this.props.dragSourceId.length||this.props.dragSourceId===t.dragSourceId&&this.state.dragState===r.dragState)return;if(!this.props.isOver)return;switch(this.state.dragState){case h.reparent:this.props.reparentHover(this.props.dragSourceId,this.props.item);return;case h.reorderBefore:this.props.reorderBefore(this.props.dragSourceId,this.props.item);return;case h.reorderAfter:this.props.reorderAfter(this.props.dragSourceId,this.props.item)}}}]);return a}(m.default.Component);var T={beginDrag:function e(t,r){return{item:t.item.id,name:t.item.displayName}},canDrag:function e(t){return!t.preventDrag},isDragging:function e(t,r){return t.item.id===r.getItem().item},endDrag:function e(t,r){r.didDrop()||t.cancelDrag(t.item.id)}};var N=function e(t,r){return{connectDragSource:t.dragSource(),connectDragPreview:t.dragPreview()}};var S={drop:function e(t,r,a){var o=a.getDecoratedComponentInstance().dom.getBoundingClientRect();var s=(o.bottom+o.top)/2;var n=o.bottom-r.getClientOffset().y;var i=n>=b&&n<E;if(i&&t.canReparent){t.reparentDrop(r.getItem().item,t.item);return}s-r.getClientOffset().y<0?t.reorderDrop(r.getItem().item,t.item):t.reorderDrop(r.getItem().item,t.item,true)},hover:function e(t,r,a){if(r.getItem().item===t.item.id)return;var o=a.dom.getBoundingClientRect();var s=(o.bottom+o.top)/2;var n=o.bottom-r.getClientOffset().y;var i=n>=b&&n<E;if(i&&t.canReparent){a.setState({dragState:h.reparent});return}s-r.getClientOffset().y<0?a.setState({dragState:h.reorderAfter}):a.setState({dragState:h.reorderBefore})}};var D=function e(t,r){if(!r.getItem()||!r.isOver())return{connectDropTarget:t.dropTarget(),dragSourceId:"",isOver:r.isOver(),dragState:h.reset};return{connectDropTarget:t.dropTarget(),dragSourceId:r.getItem().item,isOver:r.isOver()}};var x=(0,c.default)([(0,f.DragSource)(y,T,N),(0,f.DropTarget)(y,S,D)])(w);t.default=x;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/index.tsx":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=a(r("./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/NestedCategoriesEditor.tsx"));var s=o.default;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/Commerce/screens/ProductDialog/NestedCategoriesEditor/styles.less":function(e,t,r){e.exports={popOverZIndex:"_1SxPP6YdR",formView:"_39hE0DxSO",closeAction:"_3OUavDA0v",upperCase:"_3lDzP5cyi",flyoutTitle:"_61kTFjobZ",flyoutTitleColor:"_3W2ykwUGJ",fullSlugPrefix:"_3yKPjVfi2",flyoutTitleSelected:"BmXA4mGWR",fixedWidth:"_38OY54MJ5",hideDetailedEditor:"_1fwzv3lXL",showEditor:"_2p-vYG4qm",buttonAlignment:"_1lbiR_4oB",childCategory:"_1QsJN86yw",category:"_23klvjp-U",deleteButton:"_3vCs_DZbX",categoryPopover:"_268jLdadp",dragPreview:"_1qUQwLRjR",expandIcon:"_14wcdYjFu",dragIcon:"yOv32UOvw",expandCollapse:"_2Frtojxop",dragHandleContainer:"_5f7eG6Ffm",rotateChevron:"_3HjcX_aQ5",disclosure:"_2IqMrE6tS",openDisclosure:"yly-_pBmO",hovered:"_3cYmt8kJT",separator:"_1dunUjJdN",addButton:"_3Gb7Jz1TL",grabbing:"_3N9fuXBc_",reorderAfter:"_3d526odUF",reorderBefore:"_7i4NQC5eC",iconContainer:"B6Z9y8n1T",disabledButton:"_2qxydtimk",addIcon:"_15onY6Xtx",addIconHeader:"_2mEB2Icfr",hidden:"_14BwDD9zP",pointer:"BiC13COLK",translucent:"_3W_55tmdO",filterPadding:"_20zmkJb5h",addContainer:"_2aFiYX_HK",inputWidth:"_2LJ0wKuy5",dragLayerStyle:"_1LpyE28uY",flyoutWidth:"_14l5HnuaM",flyoutHeader:"_3Os7_eB61",showError:"_1uehQy5wp",showLoading:"_2168wgOki",editPanelMargin:"_3b0DeeDLt",popupStyles:"DSZ3cebbL",searchContainer:"gRIuY_xpi"}},"./src/main/webapp/universal/src/apps/App/screens/Settings/screens/SEOPanel/utils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.updateLegacyFormat=void 0;var a=function e(t){return t.replace(new RegExp("%c","g"),"%p")};t.updateLegacyFormat=a},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/GifWarningModal.js":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var s=a(r("./common/temp/node_modules/react/index.js"));var o=a(r("./common/temp/node_modules/prop-types/index.js"));var n=a(r("./common/temp/node_modules/@sqs/core-components/web/modals/ConfirmModal.js"));var i=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var l=function e(t){var r=t.isOpen,a=t.onConfirm,o=t.onDismiss;return s.default.createElement(n.default,{title:(0,i.t)("Animated GIFs aren’t supported."),message:(0,i.t)("When you edit an animated GIF, you’ll only edit the very first frame and make the image static."),isOpen:r,onConfirm:a,onDismiss:o,onRequestClose:o,confirmStyle:"default",cancelStyle:"default",confirmLabel:(0,i.t)("Edit Anyway"),cancelLabel:(0,i.t)("Cancel"),baseZIndex:4e4})};l.propTypes={isOpen:o.default.bool,onConfirm:o.default.func,onDismiss:o.default.func};l.defaultProps={isOpen:false,onConfirm:function e(){},onDismiss:function e(){}};var d=l;t.default=d;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/ImageEditor.js":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=t.convertImageSrcToLocal=void 0;var s=a(r("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=a(r("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var n=a(r("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=a(r("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var l=a(r("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var d=a(r("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var u=a(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var c=a(r("./common/temp/node_modules/react/index.js"));var p=a(r("./common/temp/node_modules/prop-types/index.js"));var m=r("./common/temp/node_modules/@sqs/core-components/lib/web/Modal.js");var f=a(r("./common/temp/node_modules/@sqs/core-components/lib/web/CircularProgressIndicator.js"));var g=a(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/WelcomeModal.js"));var v=a(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/GifWarningModal.js"));var h=a(r("./src/main/webapp/universal/src/apps/App/routes/AsyncComponent.js"));var y=a(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/ImageEditor.less"));var C=a(r("./src/main/webapp/universal/src/shared/utils/UrlUtils.js"));var b=a(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/MessageBundle.js"));var E=a(r("./common/temp/node_modules/@sqs/error-reporter/dist/index.js"));var w=r("./common/temp/node_modules/@sqs/rosetta-styled/build/lib/index.js");var T=r("./common/temp/node_modules/@sqs/rosetta-themes/build/lib/index.js");function N(o){var s=S();return function e(){var t=(0,d.default)(o),r;if(s){var a=(0,d.default)(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return(0,l.default)(this,r)}}function S(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}var D=function e(){return c.default.createElement("div",{className:y.default.spinner},c.default.createElement(f.default,{size:"large"}))};var x=["images.squarespace-cdn.com","image-origin.dev.squarespace.net"];var _=(0,h.default)(function(){return Promise.all([r.e(7),r.e(148)]).then(r.t.bind(null,"./common/temp/node_modules/@sqs/image-editor-ui/dist/image-editor-ui.js",7))},D);var j=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.origin;var a=C.default.getHostName(t||"");if(x.find(function(e){return a===e}))return t+"?format=2500w";return r+C.default.getPath(t).replace(/^[\/]{0,1}static\//,"/static/image-editor/")+"?format=2500w"};t.convertImageSrcToLocal=j;var O=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!t)return false;return-1!==t.indexOf(".gif")||-1!==t.indexOf("image/gif")};var A=function(e){(0,i.default)(r,e);var t=N(r);function r(e){var o;(0,s.default)(this,r);o=t.call(this,e);(0,u.default)((0,n.default)(o),"handleSave",function(e){var t=o.props,r=t.onSave,a=t.imageSrc;setTimeout(function(){E.default.trackCaughtError("ImageEditor","ImageEditorSaveEvent : Previous Source: ".concat(a))},0);r(e)});(0,u.default)((0,n.default)(o),"handleGifWarningConfirm",function(){o.setState({isGifWarningOpen:false,isOpen:true})});(0,u.default)((0,n.default)(o),"handleGifWarningCancel",function(){o.props.onCancel();o.setState({isGifWarningOpen:false})});o.state={isOpen:false,instanceId:0,isGifWarningOpen:false};return o}(0,o.default)(r,[{key:"render",value:function e(){var t=this.props,r=t.onCancel,a=t.imageSrc,o=t.imageFileName;var s=this.state,n=s.instanceId,i=s.isGifWarningOpen,l=s.isOpen;return c.default.createElement("div",{onClick:function e(t){return t.stopPropagation()},onKeyUp:function e(t){t.stopPropagation()}},c.default.createElement(m.BaseModal,{className:y.default.modal,isOpen:l,closeTimeoutMS:220,baseZIndex:4e4,style:{content:{position:"absolute",top:"0",left:"0",transform:""}}},c.default.createElement("div",{className:"image-picker-overlay escmanager-ignore"},l&&c.default.createElement(w.ThemeContext.Provider,{theme:T.rosetta.white},c.default.createElement(_,{instance:n,onSave:this.handleSave,onCancel:r,imageSrc:j(a),imageFileName:o,messages:b.default,showExperimentalFeatures:true,webglEnabled:true})))),c.default.createElement(g.default,{isImageEditorOpen:l}),c.default.createElement(v.default,{isOpen:i,onConfirm:this.handleGifWarningConfirm,onDismiss:this.handleGifWarningCancel}))}}],[{key:"getDerivedStateFromProps",value:function e(t,r){var a={};var o=O(t.imageSrc);t.isOpen&&!r.isOpen?Object.assign(a,{isGifWarningOpen:o,isOpen:!o,instanceId:r.instanceId+1}):!t.isOpen&&r.isOpen&&Object.assign(a,{isOpen:false,isGifWarningOpen:false});return a}}]);return r}(c.default.Component);(0,u.default)(A,"propTypes",{imageSrc:p.default.string,imageFileName:p.default.string,isOpen:p.default.bool,onSave:p.default.func.isRequired,onCancel:p.default.func.isRequired});var I=A;t.default=I},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/ImageEditor.less":function(e,t,r){e.exports={modal:"_5QASYn073",spinner:"XuToppQ-a"}},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/MessageBundle.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var a=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var o={SAVE:(0,a.t)("Save"),CANCEL:(0,a.t)("Cancel"),FLIP_X:(0,a.t)("Flip X"),FLIP_Y:(0,a.t)("Flip Y"),RESET_ADJUST:(0,a.t)("Reset"),BRIGHTNESS:(0,a.t)("Brightness"),SATURATION:(0,a.t)("Saturation"),SHARPNESS:(0,a.t)("Sharpness"),BLUR:(0,a.t)("Blur"),CONTRAST:(0,a.t)("Contrast"),HIGHLIGHTS:(0,a.t)("Highlights"),SHADOWS:(0,a.t)("Shadows"),RESET_CROP:(0,a.t)("Reset"),FILTER_STRENGTH:(0,a.t)("Strength"),REVIEW_CANCEL:{CANCEL_LABEL:(0,a.t)("Resume"),CONFIRM_LABEL:(0,a.t)("Discard"),MESSAGE:(0,a.t)("Are you sure you want to discard your changes? This can't be undone.")},REVIEW_SAVE:{CANCEL_LABEL:(0,a.t)("Resume"),CONFIRM_LABEL:(0,a.t)("Save"),MESSAGE:(0,a.t)("Are you sure you want to save your changes? This will be permanent.")},EDITOR_TYPE:{LIGHT_AND_COLOR:(0,a.t)("Adjust"),CROP_AND_ROTATE:(0,a.t)("Crop"),FILTER:(0,a.t)("Filter")},FILTER_CONFIG:{VOYAGER:(0,a.t)("Voyager"),APOLLO:(0,a.t)("Apollo"),CASSINI:(0,a.t)("Cassini"),GRAMERCY:(0,a.t)("Gramercy"),DENALI:(0,a.t)("Denali"),NIAGARA:(0,a.t)("Niagara"),DELAVAN:(0,a.t)("Delavan"),FACET:(0,a.t)("Facet"),FRIEZE:(0,a.t)("Frieze"),SERENGETI:(0,a.t)("Serengeti"),SAVANNAH:(0,a.t)("Savannah")},CROP_CONFIG:{ORIGINAL:(0,a.t)("Original"),TWO_THREE:(0,a.t)("2:3"),THREE_FOUR:(0,a.t)("3:4"),FOUR_FIVE:(0,a.t)("4:5"),NINE_SIXTEEN:(0,a.t)("9:16"),CUSTOM:(0,a.t)("Custom"),ONE_ONE:(0,a.t)("1:1"),THREE_TWO:(0,a.t)("3:2"),FOUR_THREE:(0,a.t)("4:3"),FIVE_FOUR:(0,a.t)("5:4"),SIXTEEN_NINE:(0,a.t)("16:9")}};t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/WelcomeModal.js":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var o=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=o(r("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=o(r("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var i=o(r("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var l=o(r("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var d=o(r("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=o(r("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=o(r("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));r("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var p=o(r("./common/temp/node_modules/react/index.js"));var m=o(r("./common/temp/node_modules/prop-types/index.js"));var f=o(r("./common/temp/node_modules/alt-utils/lib/connectToStores.js"));var g=o(r("./src/main/webapp/universal/src/apps/App/shared/stores/AuthenticatedAccountStore.js"));var v=r("./src/main/webapp/universal/src/shared/i18n/index.ts");var h=r("./src/main/webapp/universal/src/shared/i18n/react.ts");var y=o(r("./common/temp/node_modules/@sqs/core-components/web/primitives/Button.js"));var C=o(r("./common/temp/node_modules/@sqs/core-components/lib/web/Modal.js"));var b=a(r("./src/main/webapp/frontend/packages/knowledge-base-links/lib/index.js"));var E=o(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/WelcomeModal.less"));function w(o){var s=T();return function e(){var t=(0,u.default)(o),r;if(s){var a=(0,u.default)(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return(0,d.default)(this,r)}}function T(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}var N="image-editor-1-welcome-message";var S=15447024e5;var D=function(e){(0,l.default)(r,e);var t=w(r);function r(e){var s;(0,n.default)(this,r);s=t.call(this,e);(0,c.default)((0,i.default)(s),"shouldShowModal",function(){var e=s.props,t=e.hasSeenWelcomeMessage,r=e.memberAccountCreatedOn,a=e.isImageEditorOpen;var o=s.state.isWelcomeDismissed;return!!(a&&!t&&r<S&&!o)});(0,c.default)((0,i.default)(s),"onCloseWelcomeMessage",function(){g.default.markTutorialCompleted(N);s.setState({isWelcomeDismissed:true})});s.state={isWelcomeDismissed:false};return s}(0,s.default)(r,[{key:"render",value:function e(){return p.default.createElement(C.default,{isOpen:this.shouldShowModal(),message:p.default.createElement("div",{className:E.default.welcomeModal},p.default.createElement("h2",{className:E.default.welcomeModalTitle},p.default.createElement(h.T,{project:"imageEditor.ui"},"Welcome to the new Squarespace Image Editor")),p.default.createElement("p",{className:E.default.welcomeModalText},p.default.createElement(h.T,{project:"imageEditor.ui",learnMore:p.default.createElement("a",{href:"".concat(b.IMAGE_EDITOR,"#toc-my-image-editor-looks-different"),target:"_blank"},p.default.createElement(h.T,{project:"imageEditor.ui"},"Learn more"))},"Designed to help you make essential edits. {learnMore}")),p.default.createElement(y.default,{color:"default",alignment:"center",inverted:true,label:(0,v.t)("Get Started"),onClick:this.onCloseWelcomeMessage,underlined:false,className:E.default.welcomeDismissButton})),baseZIndex:4e4,maxWidth:330})}}]);return r}(p.default.Component);(0,c.default)(D,"propTypes",{memberAccountCreatedOn:m.default.number.isRequired,hasSeenWelcomeMessage:m.default.bool.isRequired,isImageEditorOpen:m.default.bool.isRequired});var x=(0,f.default)({getStores:function e(){return[g.default]},getPropsFromStores:function e(){var t=g.default.isTutorialCompleted(N);var r=g.default.getState().toJS().createdOn;return{hasSeenWelcomeMessage:t,memberAccountCreatedOn:r}}},D);t.default=x;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/WelcomeModal.less":function(e,t,r){e.exports={welcomeModal:"_14AVkt7ko",welcomeModalTitle:"_1q-lK44i0",welcomeModalText:"_3Z9XSzeiv",welcomeDismissButton:"_1C5n2duLv"}},"./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/index.js":function(e,t,r){"use strict";var a=r("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=a(r("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/ImageEditor.js"));var s=o.default;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/utils/StructuredInputUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.buildRegexes=t.getPreviewString=void 0;var a=function e(r,a,t){return Object.keys(a).reduce(function(e,t){return e.replace(r[t],a[t].exampleText)},t)};t.getPreviewString=a;var o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).reduce(function(e,t){e[t]=new RegExp(t,"g");return e},{})};t.buildRegexes=o}}]);
//# sourceMappingURL=https://sourcemaps.squarespace.net/universal/scripts-compressed/11-a977f67630ba5541f0907-min.en-US.js.map